<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artwork Details - Godrej Properties</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="styles_new.css">
</head>

<body>
    <!-- Header (optional - you can include the same header as main page) -->
    <header class="header-artwork-details-page-main">
        <dev class="header-artwork-details-page">
            <div class="header-container">
                <a href="index.html" class="logo">
                    <img src="images/logo/FINAL GODREJ LOGO 1(WHITE)-01 (2) copy.png" alt="Godrej Properties">
                </a>
            </div>
            <div class="border-wrapper">
                <span class="centered-border"></span>
            </div>
        </dev>
        <div class="detail-header">
            <button class="back-btn" id="backBtn" onclick="goBack()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15,18 9,12 15,6"></polyline>
                </svg>
                Back to Gallery
            </button>
        </div>
    </header>
    
    <!-- Artwork Details Page Content -->
    <div class="artwork-details-page">
        <div class="flipbook-container">
            <div class="flipbook">
                <div>
                    <img src="images\Books\1.png" alt="" />
                </div>
                <div>
                    <img src="images\Books\2.png" alt="" />
                </div>
                <div>
                    <img src="images\Books\3.png" alt="" />
                </div>
                <div>
                    <img src="images\Books\4.png" alt="" />
                </div>
                <div>
                    <img src="images\Books\5.png" alt="" />
                </div>
            </div>
            <div class="flipbook-controls">
                <button class="page-btn prev-btn" id="prevPage">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15,18 9,12 15,6"></polyline>
                    </svg>
                    Previous
                </button>
                <button class="page-btn next-btn" id="nextPage">
                    Next
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="9,18 15,12 9,6"></polyline>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Footer (optional) -->
    <footer class="footer">
        <div class="container">
            <div class="footer-inner">
                <div class="footer-content">
                    <a href="https://www.godrejproperties.com/" target="_blank" class="logo">
                        <img src="images/logo/Godrej Properties Logo.png" alt="Godrej Properties">
                    </a>
                    <div class="footer-text">
                        <p>Copyright &copy; 2025. Godrej Properties</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="jquery.js"></script>
    <script src="turn.js"></script>
    <script>
        $(document).ready(function () {
            // Function to check if device is mobile
            function isMobile() {
                return window.innerWidth <= 768;
            }

            // Function to get flipbook dimensions based on screen size
            function getFlipbookDimensions() {
                const screenWidth = window.innerWidth;
                const screenHeight = window.innerHeight;
                let width, height;

                // iPhone and small mobile devices
                if (screenWidth <= 390) {
                    width = Math.min(screenWidth - 30, 300);
                    height = width / 2;
                }
                // Standard mobile phones (iPhone 13, 14, 15, 16)
                else if (screenWidth <= 430) {
                    width = Math.min(screenWidth - 40, 350);
                    height = width / 2;
                }
                // Large mobile phones and small tablets
                else if (screenWidth <= 768) {
                    width = Math.min(screenWidth - 60, 400);
                    height = width / 2;
                }
                // Tablets (iPad, Android tablets)
                else if (screenWidth <= 1024) {
                    width = Math.min(screenWidth - 100, 600);
                    height = width / 2;
                }
                // Small laptops and large tablets
                else if (screenWidth <= 1366) {
                    width = 800;
                    height = 400;
                }
                // Desktop screens
                else {
                    width = 1800;
                    height = 900;
                }

                // Ensure the flipbook doesn't exceed viewport height
                const maxHeight = screenHeight - 250; // More space for headers/controls
                if (height > maxHeight) {
                    height = maxHeight;
                    width = height * 2;
                }

                return {
                    width,
                    height,
                    display: (screenWidth <= 768) ? 'single' : 'double'
                };
            }

            // Additional function to get device-specific settings
            function getDeviceSpecificSettings() {
                const userAgent = navigator.userAgent;
                const screenWidth = window.innerWidth;

                // iPhone specific adjustments
                if (/iPhone/.test(userAgent)) {
                    if (screenWidth <= 375) {
                        // iPhone SE, iPhone 12 mini
                        return { padding: 60, controlGap: 15 };
                    } else if (screenWidth <= 390) {
                        // iPhone 12, 13, 14
                        return { padding: 70, controlGap: 20 };
                    } else if (screenWidth <= 430) {
                        // iPhone 14 Plus, 15 Plus, 16 Pro Max
                        return { padding: 80, controlGap: 25 };
                    }
                }

                // Default settings
                return { padding: 80, controlGap: 20 };
            }

            // Initialize flipbook with responsive settings
            function initializeFlipbook() {
                const dimensions = getFlipbookDimensions();
                const mobile = window.innerWidth <= 768;
                let currentPage = 1;

                // Store current page if flipbook exists
                if ($(".flipbook").turn("is")) {
                    currentPage = $(".flipbook").turn("page");
                    $(".flipbook").turn("destroy");
                }

                // Set fixed container dimensions first
                $('.flipbook-container').css({
                    'min-height': dimensions.height + 100 + 'px',
                    'display': 'flex',
                    'flex-direction': 'column',
                    'align-items': 'center',
                    'justify-content': 'center'
                });

                // Initialize flipbook with stable settings
                $(".flipbook").turn({
                    width: dimensions.width,
                    height: dimensions.height,
                    autoCenter: true,
                    gradients: !mobile,
                    elevation: mobile ? 0 : 20, // Reduce elevation to prevent position shifts
                    display: dimensions.display,
                    acceleration: false, // Disable acceleration to prevent jumping
                    page: currentPage, // Start at the stored page
                    duration: mobile ? 600 : 1000, // Slower animation on mobile
                    when: {
                        turning: function (event, page, view) {
                            // Prevent scroll during page turn
                            $('body').addClass('turning');
                        },
                        turned: function (event, page, view) {
                            // Re-enable scroll after page turn
                            $('body').removeClass('turning');
                            updateNavigationButtons();

                            // Ensure flipbook stays centered after turn
                            setTimeout(function () {
                                $('.flipbook').css({
                                    'margin': '0 auto',
                                    'display': 'block',
                                    'position': 'relative'
                                });
                            }, 100);
                        },
                        missing: function (event, pages) {
                            console.log('Missing pages:', pages);
                        }
                    }
                });

                // Force center positioning
                $('.flipbook').css({
                    'margin': '0 auto',
                    'display': 'block',
                    'position': 'relative',
                    'top': '0',
                    'left': '0',
                    'transform': 'none'
                });

                updateNavigationButtons();
            }
            // Initialize flipbook on page load
            initializeFlipbook();

            // Reinitialize flipbook on window resize with debouncing
            let resizeTimeout;
            $(window).on('resize orientationchange', function () {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(function () {
                    const currentPage = $(".flipbook").turn("page");
                    initializeFlipbook();
                    // Restore current page after resize
                    $(".flipbook").turn("page", currentPage);
                }, 300);
            });

            // Previous page button
            $("#prevPage").click(function () {
                if (!$(this).prop("disabled")) {
                    $(".flipbook").turn("previous");
                }
            });

            // Next page button  
            $("#nextPage").click(function () {
                if (!$(this).prop("disabled")) {
                    $(".flipbook").turn("next");
                }
            });

            // Touch swipe support for mobile
            let touchStartX = 0;
            let touchStartY = 0;
            let touchEndX = 0;
            let touchEndY = 0;

            $(".flipbook").on('touchstart', function (e) {
                touchStartX = e.originalEvent.touches[0].clientX;
                touchStartY = e.originalEvent.touches[0].clientY;
            });

            $(".flipbook").on('touchend', function (e) {
                touchEndX = e.originalEvent.changedTouches[0].clientX;
                touchEndY = e.originalEvent.changedTouches[0].clientY;
                handleSwipe();
            });

            function handleSwipe() {
                const swipeThreshold = 50;
                const diffX = touchStartX - touchEndX;
                const diffY = Math.abs(touchStartY - touchEndY);

                // Only handle horizontal swipes (ignore vertical scrolling)
                if (Math.abs(diffX) > swipeThreshold && diffY < 100) {
                    if (diffX > 0) {
                        // Swipe left - next page
                        if (!$("#nextPage").prop("disabled")) {
                            $(".flipbook").turn("next");
                        }
                    } else {
                        // Swipe right - previous page
                        if (!$("#prevPage").prop("disabled")) {
                            $(".flipbook").turn("previous");
                        }
                    }
                }
            }

            // Sticky header functionality
            const header = $('.header-artwork-details-page');
            const detailHeader = $('.detail-header');
            const flipbookContainer = $('.flipbook-container');
            const headerHeight = header.outerHeight();

            $(window).scroll(function () {
                const scrollTop = $(this).scrollTop();

                // When user scrolls past the main header
                if (scrollTop > headerHeight) {
                    detailHeader.addClass('sticky');
                    flipbookContainer.addClass('header-sticky');
                } else {
                    // When user scrolls back up to see the main header
                    detailHeader.removeClass('sticky');
                    flipbookContainer.removeClass('header-sticky');
                }
            });

            // Keyboard navigation
            $(document).keydown(function (e) {
                // Only handle keyboard navigation if flipbook is visible and focused
                if ($(".flipbook").is(":visible")) {
                    switch (e.which) {
                        case 37: // Left arrow
                            e.preventDefault();
                            if (!$("#prevPage").prop("disabled")) {
                                $(".flipbook").turn("previous");
                            }
                            break;
                        case 39: // Right arrow  
                            e.preventDefault();
                            if (!$("#nextPage").prop("disabled")) {
                                $(".flipbook").turn("next");
                            }
                            break;
                        case 32: // Spacebar
                            e.preventDefault();
                            if (!$("#nextPage").prop("disabled")) {
                                $(".flipbook").turn("next");
                            }
                            break;
                    }
                }
            });
        });

        // Update button states based on current page
        function updateNavigationButtons() {
            if ($(".flipbook").turn("is")) {
                const currentPage = $(".flipbook").turn("page");
                const totalPages = $(".flipbook").turn("pages");

                // Disable/enable previous button
                $("#prevPage").prop("disabled", currentPage <= 1);

                // Disable/enable next button
                $("#nextPage").prop("disabled", currentPage >= totalPages);

                // Update button appearance
                if (currentPage <= 1) {
                    $("#prevPage").addClass("disabled");
                } else {
                    $("#prevPage").removeClass("disabled");
                }

                if (currentPage >= totalPages) {
                    $("#nextPage").addClass("disabled");
                } else {
                    $("#nextPage").removeClass("disabled");
                }
            }
        }

        // Function to go back to main page
        function goBack() {
            window.history.back();
        }
    </script>
</body>

</html>